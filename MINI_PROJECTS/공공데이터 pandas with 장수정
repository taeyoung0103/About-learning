import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')

data = pd.read_csv('./dataset/국토안전관리원_위험요소프로파일_20201231.csv',encoding='cp949')
data

1  시설/공종 별 피해 빈도수 조사

# Series [시설종류, 공종명, 물적피해, 인적피해] table 뽑기
df = pd.DataFrame(data)
df[['시설종류','공종명','물적피해','인적피해']]
(테이블이 시설종류, 공종명, 물적피해, 인적피해 4개의 데이터만 출력된다.)


# 공종별 정리 테이블
mg = df.groupby('공종명')
mg.size()
공종명
가설공사       2
관공사        3
관로공사       2
교량공사       1
굴착공사       4
궤도공사       1
기초공사       2
기타공사       1
도로공사       1
리모델링       2
마감공사       3
방수공사       2
보강공사       1
설비공사       3
옹벽공사       1
유지보수       1
전기공사       1
조사         1
철거공사       1
철골공사       2
콘크리트공사    13
터널공사       1
해체공사       7
dtype: int64

콘크리트공사가 가장 많음을 확인할 수 있다.


2  시설종류 비율차지 그래프 만들기

fa = pd.DataFrame({'count' : df.groupby('시설종류').size()}).reset_index()
fa
	시설종류	count
0	건축	39
1	토목	17


f, ax = plt.subplots(1, 2, figsize=(18, 8))
df['시설종류'].value_counts().plot.pie(explode=[0, 0.1], autopct='%1.1f%%', ax=ax[0], shadow=True)
ax[0].set_title('시설종류 별 % 파이그래프')
ax[0].set_ylabel('')
sns.countplot('시설종류', data=df, ax=ax[1])
ax[1].set_title('시설종류 별 % 바그래프')
plt.show()

실행시 파이차트 하나와 막대그래프 하나, 총 2개가 출력된다.


3  콘트리트공사에 관한 최다원인 분석
conditions = (data['공종명'] == '콘크리트공사')
tu = data[conditions]
tu

구분	시설종류	공종명	객체	위치	작업프로세스	원인	물적피해	인적피해
0	201801	토목	콘크리트공사	벽체	인접	철근조립	전도방지 미조치	넘어짐	깔림
5	201806	토목	콘크리트공사	브라켓	하부	PC부재 조립	철근 미시공	파괴	깔림
20	201903	건축	콘크리트공사	데크플레이트	상부	타설	임의시공	무너짐	떨어짐
22	201905	건축	콘크리트공사	데크플레이트	상부	타설	용접불량	무너짐	떨어짐
23	201906	건축	콘크리트공사	철골보	상부	타설	용접불량	무너짐	떨어짐
27	201910	건축	콘크리트공사	작업발판	상부	운반	임의해체	무너짐	떨어짐
28	201911	건축	콘크리트공사	보	상부	타설	구조검토 미흡	무너짐	떨어짐
29	201912	건축	콘크리트공사	데크플레이트	상부	타설	동바리 수평연결재 간격 미준수	무너짐	떨어짐
38	201921	건축	콘크리트공사	조적벽	인접	타설	조적벽 미보강	넘어짐	없음
40	201923	건축	콘크리트공사	크레인	인접	양중	와이어 파단	넘어짐	없음
51	202009	건축	콘크리트공사	데크플레이트	상부	타설	용접불량	무너짐	떨어짐
52	202010	건축	콘크리트공사	데크플레이트	하부	운반	적재불량	낙하	맞음
53	202011	건축	콘크리트공사	가시설	상부	타설	구조검토 미흡	무너짐	떨어짐

mk = pd.DataFrame({'count' : tu.groupby('작업프로세스').size()}).reset_index()
mk
 작업프로세스	 count
0	PC부재 조립	1
1	양중	1
2	운반	2
3	철근조립	1
4	타설	8

타설 수행시 사고가 가장 많이 일어남을 확인할 수 있다.
